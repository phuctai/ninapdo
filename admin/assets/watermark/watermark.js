!function(i){function z(e){return preserverdAttributes=["containerClass","watermarkerClass","watermarkImageClass"],-1<i.inArray(e,preserverdAttributes)}function R(e,r,t){return z(e)&&null!=r?t+" "+r:t}function T(e){if(null!=e){var r={x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight,opacity:parseFloat(jQuery(e).find("img").css("opacity")).toFixed(2)};return r.jsonCoords=JSON.stringify(r),r.element=e,r}}function x(e){return null==e||0==e.length}function b(e){if(null!=e&&0<e.length)return"."==e[0]?e:"."+e}function u(e){return jQuery(e).css("opacity")}function l(e){jQuery(e).each(function(){var e,r=jQuery(this),t=r.data("pluginWatermarker");i.each(t,function(){var e=this;e.onRemove(e.watermark,e),e.watermark.remove()}),0<t.length&&(e=t[0],jQuery(e.element).appendTo(jQuery(e.container).parent()),jQuery(e.container).remove(),jQuery(document).off("mousedown",b(t[0].eventTriggerClass)+" "+b(t[0].watermarkerClass)),jQuery(document).off("mousedown",b(t[0].eventTriggerClass)+" "+b(t[0].resizerClass)),t[0].onDestroy(t[0].element,t[0])),r.removeData("pluginWatermarker")})}function P(e,r){var t,a=jQuery(r),s=a.data("pluginWatermarker");if(1<s.length){for(var n=0;n<s.length;n++)if(void 0!==s[n].watermark&&void 0!==e&&s[n].watermark[0]===e[0]){t=s[n],s.splice(n,1);break}a.data("pluginWatermarker",s),t.onRemove(t.watermark,t),e.remove()}else l(r)}i.watermarker=function(e,r){var t=jQuery("#watermark").attr("src"),a=jQuery("#watermark").attr("left"),s=jQuery("#watermark").attr("top"),p=function(e){var r={onChange:function(){},onInitialize:function(){},onDestroy:function(){},onRemove:function(){},imagePath:"images/watermark.png",removeIconPath:"images/close-icon.png",eventTriggerClass:"watermarker-wrapper",containerClass:"watermarker-wrapper",watermarkerClass:"watermarker-container",watermarkImageClass:"watermarker-image",removeClass:"watermarker-remove-item",draggingClass:"dragging",allowRemove:!1,aspectRatio:void 0};for(var t in e)e.hasOwnProperty(t)&&!z(t)&&"data"!=t&&(r[t]=e[t]);return r}(r),n=R("containerClass",r.containerClass,p.containerClass),o=R("watermarkerClass",r.watermarkerClass,p.watermarkerClass),i=R("watermarkImageClass",r.watermarkImageClass,p.watermarkImageClass),u=jQuery("<div>",{class:n});u.width(e.width()),u.height(e.height());var l=jQuery("<div>",{class:o,data:r.data}).css("left",a+"px").css("top",s+"px"),m=jQuery("<img>",{src:t,class:i}),c=jQuery("<div>",{class:p.resizerClass}),f=jQuery(e).data("pluginWatermarker");function g(e){if(null!=e)return"."==e[0]?e.substring(1):e}function d(){return"."==p.resizingClass[0]?p.resizingClass.substring(1):p.resizingClass}function y(){return"."==p.draggingClass[0]?p.draggingClass.substring(1):p.draggingClass}function h(e,r){var t=r.parentNode.offsetHeight-r.offsetTop;return null!=p.aspectRatio&&(e=jQuery(r).width()/p.aspectRatio),parseInt(e)<=0?0:parseInt(e)>t?t:e}x(f)?(u.appendTo(jQuery(e).parent()),e.appendTo(u)):u=jQuery(e).parent(),m.appendTo(l),c.appendTo(l),l.appendTo(u),l.height(h(l.height(),l[0]));function v(e){var r,t,a,s,n,o,i,u,l,m,c=document.querySelector("."+y());null!=c&&(c.parentNode,r=parseInt(e.pageX)-jQuery(c).data("difX")+"px",t=parseInt(e.pageY)-jQuery(c).data("difY")+"px",c.style.left=(a=r,n=(s=c).parentNode,o=I(n)+n.offsetWidth,parseInt(a)<=0?"0px":parseInt(a)+s.offsetWidth>o?o-s.offsetWidth+"px":a),c.style.top=(i=t,l=(u=c).parentNode,m=W(l)+l.offsetHeight,parseInt(i)<=0?"0px":parseInt(i)+u.offsetHeight>m?m-u.offsetHeight+"px":i),p.onChange(T(c)))}function j(e){jQuery(document).off("mousemove",v),jQuery("."+y()).removeClass(y())}function Q(e){var r,t,a=jQuery(p.resizer),s=a.parent()[0],n=a.data("startWidth")+e.pageX-a.data("startPositionX"),o=void 0!==p.aspectRatio&&null!==p.aspectRatio?n/p.aspectRatio:a.data("startHeight")+e.pageY-a.data("startPositionY");jQuery(s).width((r=n,t=s.parentNode.offsetWidth-s.offsetLeft,parseInt(r)<=0?0:parseInt(r)>t?t:r)),jQuery(s).height(h(o,s)),p.onChange(T(s))}var w,k,C=function(e){jQuery(document).off("mousemove",Q),jQuery(document).off("mouseup",C);var r=jQuery(p.resizer);r.removeClass(d()),r.removeData("startPositionX"),r.removeData("startPositionY"),r.removeData("startWidth"),r.removeData("startHeight"),p.resizer=void 0},I=function(e){var r=jQuery(e)[0];return 0<r.style.left.length?parseInt(r.style.left):0},W=function(e){var r=jQuery(e)[0];return 0<r.style.top.length?parseInt(r.style.top):0};return x(f)&&(jQuery(document).on("mousedown",b(p.eventTriggerClass)+" "+b(p.watermarkerClass),function(e){jQuery(this).addClass(y());var r=parseInt(jQuery(this).css("left")),t=e.pageX-r,a=parseInt(jQuery(this).css("top")),s=e.pageY-a;return jQuery(this).data("difX",t),jQuery(this).data("difY",s),jQuery(document).on("mousemove",v),jQuery(document).on("mouseup",j),!1}),jQuery(document).on("mousedown",b(p.eventTriggerClass)+" "+b(p.resizerClass),function(e){var r=jQuery(this),t=r.closest("."+p.watermarkerClass);return(p.resizer=r).addClass(d()),r.data("startPositionX",e.pageX),r.data("startPositionY",e.pageY),r.data("startWidth",t.width()),r.data("startHeight",t.height()),jQuery(document).on("mousemove",Q),jQuery(document).on("mouseup",C),!1})),p.allowRemove&&(w=jQuery("<div>",{class:p.removeClass}),k=jQuery("<img>",{src:p.removeIconPath}),w.append(k),jQuery(l).append(w),jQuery(l).on("click","."+g(p.removeClass),function(e){P(jQuery(this).closest("."+g(p.watermarkerClass)),p.element)})),p.container=u,p.watermark=l,p.watermarkImage=m,p.resizer=c,p.element=e,p.onInitialize(T(p.watermark[0])),p},i.fn.watermarker=function(a){var e=arguments;if("string"!=typeof a)return jQuery(this).each(function(){var e,r=a,t=jQuery(this);null!=(e=t.data("pluginWatermarker"))?e.push(i.watermarker(t,r)):(e=[]).push(i.watermarker(t,r)),t.data("pluginWatermarker",e)});switch(a){case"destroy":l(jQuery(this));break;case"opacity":switch(e.length){case 1:o=u(jQuery(this).first());break;case 2:o=u(e[1]);break;case 3:var r=jQuery(this).data("pluginWatermarker")[0],t=jQuery(e[1]),s=t.hasClass(function(e){if(null!=e&&0<e.length)return"."==e[0]?e.substring(1):e}(r.watermarkImageClass))?t:t.find(b(r.watermarkImageClass)),n=e[2],o=void jQuery(s).css("opacity",n)}return o;case"remove":1<e.length&&1==jQuery(this).length&&P(e[1],this)}return this}}(jQuery),function(){function e(e){jQuery("#posleft").val(e.x),jQuery("#postop").val(e.y)}jQuery("#watermarker-icon").watermarker({onChange:e,onInitialize:e,containerClass:"myContainer",watermarkImageClass:"myImage superImage",watermarkerClass:"js-watermark-1 js-watermark",data:{id:1,class:"superclass",pepe:"pepe"},onRemove:function(){"undefined"!=typeof console&&void 0!==console.log&&console.log("Removing...")},onDestroy:function(){"undefined"!=typeof console&&void 0!==console.log&&console.log("Destroying...")}}),jQuery(document).on("mousemove",function(e){jQuery("#mousex").val(e.pageX),jQuery("#mousey").val(e.pageY)})}();